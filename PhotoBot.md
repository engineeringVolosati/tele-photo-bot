# PhotoBot

### БД

Предполагается использовать Sqlite 
3 основных рабочих дока: 
1. Фото: 
	1. Ключ - имя файла с подпапкой *cats/filename*. 
	2. Значение - json строка. User, time, tags, somethingElse
2. Список валидных категорий
3. Служебные, типа ключей, хостов, путей, пины, юзеры, админы, итд

---

### Категории

Управление категориями либо напрямую в бд, либо командами */tag_set* и */
tag_remove*, далее список категорий через пробел и(или) запятую
> 	`/tag_set cat, dog, analizer, stage`
> 
> 	`/tag_remove analizer stage`
> 
> 	`"allowed_tag": ["#cat", "#dog"]`

Установка категории по умолчанию: `#tag`. 
Возможно задать несколько категорий для фото или альбома, тэги должны быть в теле сообщения. В этом случае категория по умолчанию не меняется

При использовании нескольких категорий файл копируется в папку первого тэга. В папках остальных категорий ==создаётся хардлинк (#TODO : возможно ли создавать хардлинки на самбе?) или== копируется тело файла

---

### Пользователи

Имеется один ssu, владелец бд. Имеет возможность установить политику партии. Выдать пины для регистрации админов, юзеров. Устанавливать срок хранения пинов в бд. Удаление пользователя или отключение прав админа прямым изменением в бд. 

Пользователь с одноразовым пином при старте бота получателя в запрос на ввод пина. После получения пина ботом пин удаляется из бд. Пользователь добавляется в бд 
> `user_id: {isAdmin: bool, username: "", somethingElse: ""`

Если бот общедоступный то можно в политиках указать что `if _pin == None: add_regular_user(user_id)` 

Администраторы могут генерировать пины `/new_pin numOfPins isAdmin=1`
> `/new_pin 2 1`
> `>>> 1234`
> `>>> 4321`
> `>>> 2 pins was added to db for create new admins access`

> `/new_pin 33`
> `>>> list of pins... `
> `>>> 33 pins was added to db for create new users accounts`



